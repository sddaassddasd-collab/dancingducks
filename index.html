<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dancing Ducks</title>
  <style>
    :root{
      --bg:#0b1e3a;          /* æ·±è—èƒŒæ™¯ */
      --card:#0f254d;        /* å¡ç‰‡åº•è‰² */
      --glass: rgba(255,255,255,.08);
      --radius:18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      background:var(--bg);
      color:#e5edf7;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans TC","Helvetica Neue",Arial,sans-serif;
      display:flex; align-items:center; justify-content:center;
      padding:24px;
    }
    .row{
      width:min(1100px,96vw);
      display:grid;
      grid-template-columns: repeat(3,1fr);
      gap:20px;
    }
    .duck{
      background: linear-gradient(180deg,var(--card),#0b1e3a);
      border:1px solid var(--glass);
      border-radius: var(--radius);
      padding:18px 16px 14px;
      text-align:center;
      box-shadow: 0 14px 40px rgba(0,0,0,.35);
    }
    .imgwrap{
      display:flex; justify-content:center; align-items:center;
      aspect-ratio: 1 / 1;   /* æ­£æ–¹å½¢å±•ç¤ºå€ */
      overflow:hidden; border-radius:14px;
      background: rgba(255,255,255,.04);
    }
    .duck img{
      width: 85%; height:auto; user-select:none; -webkit-user-drag:none;
      will-change: transform;
    }

    /* éœ‡å‹•ï¼ˆä¸Šä¸‹è¼•å¾®é»é ­ï¼‰â€” 1 ç§’ä¸€ä¸‹ï¼Œå…± 15 ç§’ */
    @keyframes bob {
      0%   { transform: translateY(0) }
      50%  { transform: translateY(-8px) }
      100% { transform: translateY(0) }
    }
    .bob {
      animation: bob 1s ease-in-out 15;
    }

    .controls{
      margin-top:12px;
      display:flex; justify-content:center; gap:8px;
    }
    .radio-btn{
      font-size: 28px; line-height:1;
      background: #18325f; border:1px solid var(--glass);
      border-radius: 999px; padding:10px 16px;
      cursor:pointer;
      box-shadow: 0 8px 24px rgba(0,0,0,.35), inset 0 0 0 1px rgba(255,255,255,.05);
      transition: transform .08s ease, box-shadow .2s ease, background .2s ease;
    }
    .radio-btn:hover{ transform: translateY(-1px) }
    .radio-btn:active{ transform: translateY(0) scale(.98) }
    .label{
      font-size:14px; opacity:.8; margin-top:6px;
      letter-spacing:.02em;
    }

    @media (max-width: 900px){
      .row{ grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <main class="row">
    <!-- Duck 1 -->
    <section class="duck" data-id="1">
      <div class="imgwrap">
        <img src="duck1.png" alt="Duck 1" id="img-1">
      </div>
      <div class="controls">
        <button class="radio-btn" aria-label="æ’­æ”¾ Duck 1 éŸ³æ•ˆ" data-audio="dance1.mp3" data-target="img-1">ğŸ“»</button>
      </div>
      <div class="label">é»æ“Šæ”¶éŸ³æ©Ÿæ’­æ”¾ï¼šdance1.mp3ï¼ˆéœ‡å‹• 15 ç§’ï¼‰</div>
      <audio id="audio-1" preload="auto">
        <source src="dance1.mp3" type="audio/mpeg">
      </audio>
    </section>

    <!-- Duck 2 -->
    <section class="duck" data-id="2">
      <div class="imgwrap">
        <img src="duck2.png" alt="Duck 2" id="img-2">
      </div>
      <div class="controls">
        <button class="radio-btn" aria-label="æ’­æ”¾ Duck 2 éŸ³æ•ˆ" data-audio="dance2.mp3" data-target="img-2">ğŸ“»</button>
      </div>
      <div class="label">é»æ“Šæ”¶éŸ³æ©Ÿæ’­æ”¾ï¼šdance2.mp3ï¼ˆéœ‡å‹• 15 ç§’ï¼‰</div>
      <audio id="audio-2" preload="auto">
        <source src="dance2.mp3" type="audio/mpeg">
      </audio>
    </section>

    <!-- Duck 3 -->
    <section class="duck" data-id="3">
      <div class="imgwrap">
        <img src="duck3.png" alt="Duck 3" id="img-3">
      </div>
      <div class="controls">
        <button class="radio-btn" aria-label="æ’­æ”¾ Duck 3 éŸ³æ•ˆ" data-audio="dance3.mp3" data-target="img-3">ğŸ“»</button>
      </div>
      <div class="label">é»æ“Šæ”¶éŸ³æ©Ÿæ’­æ”¾ï¼šdance3.mp3ï¼ˆéœ‡å‹• 15 ç§’ï¼‰</div>
      <audio id="audio-3" preload="auto">
        <source src="dance3.mp3" type="audio/mpeg">
      </audio>
    </section>
  </main>

  <script>
    // ç‚ºé¿å…å¤šæ¬¡é»æ“Šé€ æˆ class ç–ŠåŠ èˆ‡è¨ˆæ™‚éŒ¯äº‚ï¼Œç‚ºæ¯éš»é´¨å­ä¿ç•™ timeout åƒè€ƒ
    const timeouts = new Map();

    function playFor(button){
      const targetId = button.dataset.target;           // å°æ‡‰ img id
      const audioSrc = button.dataset.audio;            // å°æ‡‰éŸ³æª”è·¯å¾‘
      const img = document.getElementById(targetId);
      const card = button.closest('.duck');
      const duckId = card.dataset.id;
      const audioEl = document.getElementById('audio-' + duckId);

      // è‹¥ <audio> å…§å·²æœ‰æ­£ç¢ºä¾†æºå°±ç”¨å®ƒï¼›å¦å‰‡ä¿éšªèµ·è¦‹è¨­ç½® src
      if (audioEl && audioEl.querySelector('source')?.getAttribute('src') !== audioSrc){
        audioEl.innerHTML = `<source src="${audioSrc}" type="audio/mpeg">`;
        audioEl.load();
      }

      // é‡ç½®èˆ‡æ’­æ”¾éŸ³æ•ˆï¼ˆå¿…é ˆåœ¨ä½¿ç”¨è€…é»æ“Šæ‰‹å‹¢ä¸­ï¼‰
      if (audioEl){
        try{
          audioEl.pause();
          audioEl.currentTime = 0;
        }catch(e){}
        audioEl.play().catch(()=>{/* æŸäº›ç€è¦½å™¨éœ€è¦ä½¿ç”¨è€…äº’å‹•ï¼Œé€™è£¡å·²æ˜¯é»æ“Šäº‹ä»¶ */});
      }

      // æ¸…ç†èˆŠçš„è¨ˆæ™‚å™¨å¾Œé‡æ–°åŠ ä¸Š bob å‹•ç•«
      if (timeouts.has(targetId)){
        clearTimeout(timeouts.get(targetId));
        timeouts.delete(targetId);
      }
      img.classList.remove('bob'); // é‡æ–°è§¸ç™¼å‹•ç•«çš„æŠ€å·§ï¼šå…ˆç§»é™¤å†åŠ ä¸Š
      // å¼·åˆ¶é‡ç¹ªä»¥é‡å•Ÿ CSS å‹•ç•«
      void img.offsetWidth;
      img.classList.add('bob');

      const t = setTimeout(()=>{
        img.classList.remove('bob');
        timeouts.delete(targetId);
      }, 15000); // 15 ç§’å¾Œåœæ­¢
      timeouts.set(targetId, t);
    }

    document.addEventListener('click', (e)=>{
      const btn = e.target.closest('.radio-btn');
      if (!btn) return;
      playFor(btn);
    });
  </script>
</body>
</html>